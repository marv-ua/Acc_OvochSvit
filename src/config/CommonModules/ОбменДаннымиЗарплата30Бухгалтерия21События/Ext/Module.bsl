////////////////////////////////////////////////////////////////////////////////
// Подсистема "Обмен Зарплата 3 Бухгалтерия 2.1"
// Серверные процедуры и функции, обслуживающие подписки на события.
//
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныйПрограммныйИнтерфейс

Процедура ЗаписатьНастройкиИспользованияОбменаЗарплата30Бухгалтерия21ПриЗаписи(Источник, Отказ) Экспорт
	
	ИмяПланаОбмена = ОбменДаннымиПовтИсп.ПолучитьИмяПланаОбмена(Источник.Ссылка);
	
	Если ИмяПланаОбмена <> "ОбменЗарплата30Бухгалтерия21" Тогда
		Возврат;
	КонецЕсли;
	
	Если Источник.ДополнительныеСвойства.Свойство("Загрузка") Или Источник.ДополнительныеСвойства.Свойство("ПолучениеСообщенияОбмена") Тогда
		Возврат;
	КонецЕсли;
	
	ИсточникСсылка = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Источник.Ссылка, "НомерОтправленного, НомерПринятого");
	Если ИсточникСсылка.НомерОтправленного <> Источник.НомерОтправленного Или ИсточникСсылка.НомерПринятого <> Источник.НомерПринятого Тогда
		Возврат;
	КонецЕсли;
	
	НаборЗаписей = РегистрыСведений.ИспользованиеОбменаЗарплата30Бухгалтерия21ПоОрганизациям.СоздатьНаборЗаписей();
	КонстантаМенеджер = Константы.ИспользоватьОбменЗарплата30Бухгалтерия21ПоВсемОрганизациям;
	
	ОбменДаннымиЗарплатаКадры.ОбновитьНастройкиИспользованияОбменаДанными(ИмяПланаОбмена, КонстантаМенеджер, НаборЗаписей);
	
КонецПроцедуры

Процедура ЗаписатьНастройкиИспользованияОбменаЗарплата30Бухгалтерия21ПередУдалением(Источник, Отказ) Экспорт
	
	ИмяПланаОбмена = ОбменДаннымиПовтИсп.ПолучитьИмяПланаОбмена(Источник.Ссылка);
	
	Если ИмяПланаОбмена <> "ОбменЗарплата30Бухгалтерия21" Тогда
		Возврат;
	КонецЕсли;
	
	НаборЗаписей = РегистрыСведений.ИспользованиеОбменаЗарплата30Бухгалтерия21ПоОрганизациям.СоздатьНаборЗаписей();
	КонстантаМенеджер = Константы.ИспользоватьОбменЗарплата30Бухгалтерия21ПоВсемОрганизациям;
	
	ОбменДаннымиЗарплатаКадры.ОбновитьНастройкиИспользованияОбменаДанными(ИмяПланаОбмена, КонстантаМенеджер, НаборЗаписей, Источник.Ссылка);
	
КонецПроцедуры

#КонецОбласти
