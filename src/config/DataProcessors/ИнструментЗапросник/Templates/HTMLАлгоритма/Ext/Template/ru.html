<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html;charset=utf-8" http-equiv="content-type"></meta><link rel="stylesheet" type="text/css" href="__STYLE__"></link><meta name="GENERATOR" content="MSHTML 8.00.7601.17514"></meta></head><body>
<script type="text/javascript">
<!--
function insertHTML(html) {
	try {
		var selection = window.getSelection(),
			range = selection.getRangeAt(0),
			temp = document.createElement('div'),
			insertion = document.createDocumentFragment();

		temp.innerHTML = html;

		while (temp.firstChild) {
			insertion.appendChild(temp.firstChild);
		}

		range.deleteContents();
		range.insertNode(insertion);
	} catch (z) {
		try {
			document.selection.createRange().pasteHTML(html);
		} catch (z) {}
	}
}
function showtext(text) {
	alert(text)
}

function getCaretPos(obj)
{
 obj.focus();

 if(obj.selectionStart) return obj.selectionStart;
 else if (document.selection)
 {
  var sel = document.selection.createRange();
  var clone = sel.duplicate();
  sel.collapse(true);
  clone.moveToElementText(obj);
  clone.setEndPoint('EndToEnd', sel);
  rowcount = clone.text.match(/\n/g);
  if (rowcount) {return clone.text.length - rowcount.length};
  return clone.text.length;
 }
 return 0;
}
function setSelectionRange(input, selectionStart, selectionEnd) {
  if (input.setSelectionRange) {
    input.focus();
    input.setSelectionRange(selectionStart, selectionEnd);
  }
  else if (document.body.createTextRange) {
    var range = document.body.createTextRange();
    range.collapse(true);
    range.moveEnd('character', selectionEnd);
    range.moveStart('character', selectionStart);
    range.select();
  }
}
 
function keypress(e){
if (e.keyCode==9 || e.keyCode==8 || e.keyCode==32 || e.keyCode==59) {
setTimeout('delayedevent("KeyPress")',100);

  }
else if (e.keyCode==13) {setTimeout('delayedevent("KeyPressEnt")',100);}
;
}

function delayedevent(eventtype){
 var evt = document.createEventObject();
document.getElementById("EventName").innerHTML = eventtype;
document.body.fireEvent('onclick', evt);
document.getElementById("EventName").innerHTML = '';
}

function focusout(e){
if (e.keyCode==13) {
 var evt = document.createEventObject();
 document.getElementById("EventName").innerHTML = 'focusout';
 document.body.fireEvent('onclick', evt);
 document.getElementById("EventName").innerHTML = '';
}  ;
}

function setCaretToPos (input, pos) {
  setSelectionRange(input, pos, pos);
}
</script><div onkeydown="keypress(event)" class="content" onkeypress="keypress(event)" contenteditable="true" data-target="insert"></div>
<div style="DISPLAY: none" id="ExtCommand">extcommand</div>
<div style="DISPLAY: none" id="EventName">js_event</div>
<div style="DISPLAY: none" id="BufferData">js_result</div></body></html>